description: |
  Submit test results to provider without using npm commands.
  This command directly calls the TacoTruck CLI to submit test results and artifacts.

parameters:
  provider:
    type: enum
    enum: ["testfiesta", "testrail"]
    description: "Provider of your choice. Supported platforms include: TestRail, Testfiesta etc."
  results_path:
    type: string
    default: "./test-results"
    description: "Path to the test results directory or file to submit"
  project_key:
    type: string
    default: ""
    description: "Project key for TacoTruck submission (optional if configured in project)"
  api_key:
    type: env_var_name
    description: "Environment variable name containing the TacoTruck API key"
  handle:
    type: string
    description: "Your handle or username for the provider. For testfiesta, it is your organization handle and for TestRail, it is your username."
  run_name:
    type: string
    description: "Name of the run"
  base_url:
    type: string
    default: "https://staging.api.testfiesta.com"
    description: "Base URL for the TacoTruck API (optional if using default)"

steps:
  - run:
      environment:
        PARAM_PROVIDER: <<parameters.provider>>
        PARAM_RESULTS_PATH: <<parameters.results_path>>
        PARAM_PROJECT_KEY: <<parameters.project_key>>
        PARAM_API_KEY: <<parameters.api_key>>
        PARAM_HANDLE: <<parameters.handle>>
        PARAM_RUN_NAME: <<parameters.run_name>>
        PARAM_BASE_URL: <<parameters.base_url>>
      name: Submit Test Results to <<parameters.provider>>
      command: <<include(scripts/submit.sh)>>
